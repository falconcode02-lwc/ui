<div class="profile-container">
    <div class="profile-header">
        <nz-card class="profile-card">
            <div class="profile-header-content">
                <div class="avatar-section">
                    <nz-avatar [nzSize]="120" [nzSrc]="avatarUrl" class="profile-avatar">
                    </nz-avatar>
                    <nz-upload [nzBeforeUpload]="beforeUpload" [nzShowUploadList]="false" class="avatar-upload">
                        <button nz-button nzType="default" nzSize="small">
                            <span nz-icon nzType="camera" nzTheme="outline"></span>
                            Change Avatar
                        </button>
                    </nz-upload>
                </div>
                <div class="user-info">
                    <h1 class="user-name">{{ profileForm.get('firstName')?.value }} {{
                        profileForm.get('lastName')?.value }}</h1>
                    <p class="user-email">{{ profileForm.get('email')?.value }}</p>
                    <p class="user-bio">{{ profileForm.get('bio')?.value }}</p>
                </div>
            </div>
        </nz-card>
    </div>

    <div class="profile-content">
        <!-- Left Sidebar Menu -->
        <div class="profile-sidebar">
            <ul nz-menu nzMode="inline">
                <li nz-menu-item [nzSelected]="selectedSection === 'personal'" (click)="selectSection('personal')">
                    <span nz-icon nzType="user" nzTheme="outline"></span>
                    <span>Personal Information</span>
                </li>
                <li nz-menu-item [nzSelected]="selectedSection === 'account'" (click)="selectSection('account')">
                    <span nz-icon nzType="setting" nzTheme="outline"></span>
                    <span>Account Settings</span>
                </li>
                <li nz-menu-item [nzSelected]="selectedSection === 'security'" (click)="selectSection('security')">
                    <span nz-icon nzType="lock" nzTheme="outline"></span>
                    <span>Security</span>
                </li>
                <li nz-menu-item [nzSelected]="selectedSection === 'notifications'"
                    (click)="selectSection('notifications')">
                    <span nz-icon nzType="bell" nzTheme="outline"></span>
                    <span>Notifications</span>
                </li>
            </ul>
        </div>

        <!-- Main Content Area -->
        <div class="profile-main">
            <!-- Personal Information Section -->
            <div *ngIf="selectedSection === 'personal'" class="profile-section">
                <nz-card nzTitle="Personal Information" class="content-card">
                    <form nz-form [formGroup]="profileForm" nzLayout="vertical">
                        <div nz-row [nzGutter]="16">
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label nzRequired>First Name</nz-form-label>
                                    <nz-form-control nzErrorTip="Please input your first name!">
                                        <input nz-input formControlName="firstName" placeholder="First Name" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label nzRequired>Last Name</nz-form-label>
                                    <nz-form-control nzErrorTip="Please input your last name!">
                                        <input nz-input formControlName="lastName" placeholder="Last Name" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                        </div>

                        <div nz-row [nzGutter]="16">
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label nzRequired>Email</nz-form-label>
                                    <nz-form-control nzErrorTip="Please input a valid email!">
                                        <input nz-input formControlName="email" type="email" placeholder="Email" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label>Phone</nz-form-label>
                                    <nz-form-control>
                                        <input nz-input formControlName="phone" placeholder="Phone Number" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                        </div>

                        <nz-form-item>
                            <nz-form-label>Bio</nz-form-label>
                            <nz-form-control>
                                <textarea nz-input formControlName="bio" placeholder="Tell us about yourself"
                                    [nzAutosize]="{ minRows: 3, maxRows: 6 }"></textarea>
                            </nz-form-control>
                        </nz-form-item>

                        <div nz-row [nzGutter]="16">
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label>Location</nz-form-label>
                                    <nz-form-control>
                                        <input nz-input formControlName="location" placeholder="City, Country" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label>Website</nz-form-label>
                                    <nz-form-control>
                                        <input nz-input formControlName="website"
                                            placeholder="https://yourwebsite.com" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                        </div>

                        <nz-form-item>
                            <nz-form-control>
                                <button nz-button nzType="primary" nzShape="round" [nzLoading]="loading"
                                    (click)="saveProfile()">
                                    <span nz-icon nzType="save" nzTheme="outline"></span>
                                    Save Changes
                                </button>
                            </nz-form-control>
                        </nz-form-item>
                    </form>
                </nz-card>
            </div>

            <!-- Account Settings Section -->
            <div *ngIf="selectedSection === 'account'" class="profile-section">
                <nz-card nzTitle="Account Settings" class="content-card">
                    <form nz-form [formGroup]="accountForm" nzLayout="vertical">
                        <nz-form-item>
                            <nz-form-label nzRequired>Username</nz-form-label>
                            <nz-form-control nzErrorTip="Please input your username!">
                                <input nz-input formControlName="username" placeholder="Username" />
                            </nz-form-control>
                        </nz-form-item>

                        <div nz-row [nzGutter]="16">
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label>Language</nz-form-label>
                                    <nz-form-control>
                                        <input nz-input formControlName="language" placeholder="Language" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                            <div nz-col [nzSpan]="12">
                                <nz-form-item>
                                    <nz-form-label>Timezone</nz-form-label>
                                    <nz-form-control>
                                        <input nz-input formControlName="timezone" placeholder="Timezone" />
                                    </nz-form-control>
                                </nz-form-item>
                            </div>
                        </div>

                        <nz-form-item>
                            <nz-form-label>Date Format</nz-form-label>
                            <nz-form-control>
                                <input nz-input formControlName="dateFormat" placeholder="Date Format" />
                            </nz-form-control>
                        </nz-form-item>

                        <nz-form-item>
                            <nz-form-control>
                                <button nz-button nzType="primary" nzShape="round" [nzLoading]="loading"
                                    (click)="saveAccountSettings()">
                                    <span nz-icon nzType="save" nzTheme="outline"></span>
                                    Save Settings
                                </button>
                            </nz-form-control>
                        </nz-form-item>
                    </form>
                </nz-card>
            </div>

            <!-- Security Section -->
            <div *ngIf="selectedSection === 'security'" class="profile-section">
                <nz-card nzTitle="Change Password" class="content-card">
                    <form nz-form [formGroup]="passwordForm" nzLayout="vertical">
                        <nz-form-item>
                            <nz-form-label nzRequired>Current Password</nz-form-label>
                            <nz-form-control nzErrorTip="Please input your current password!">
                                <input nz-input type="password" formControlName="currentPassword"
                                    placeholder="Current Password" />
                            </nz-form-control>
                        </nz-form-item>

                        <nz-form-item>
                            <nz-form-label nzRequired>New Password</nz-form-label>
                            <nz-form-control nzErrorTip="Password must be at least 8 characters!">
                                <input nz-input type="password" formControlName="newPassword"
                                    placeholder="New Password" />
                            </nz-form-control>
                        </nz-form-item>

                        <nz-form-item>
                            <nz-form-label nzRequired>Confirm New Password</nz-form-label>
                            <nz-form-control nzErrorTip="Please confirm your new password!">
                                <input nz-input type="password" formControlName="confirmPassword"
                                    placeholder="Confirm New Password" />
                            </nz-form-control>
                        </nz-form-item>

                        <nz-form-item>
                            <nz-form-control>
                                <button nz-button nzType="primary" nzShape="round" nzDanger [nzLoading]="loading"
                                    (click)="changePassword()">
                                    <span nz-icon nzType="lock" nzTheme="outline"></span>
                                    Change Password
                                </button>
                            </nz-form-control>
                        </nz-form-item>
                    </form>
                </nz-card>
            </div>

            <!-- Notifications Section -->
            <div *ngIf="selectedSection === 'notifications'" class="profile-section">
                <nz-card nzTitle="Notification Preferences" class="content-card">
                    <form nz-form [formGroup]="notificationForm" nzLayout="vertical">
                        <div class="notification-item">
                            <div class="notification-info">
                                <h4>Email Notifications</h4>
                                <p>Receive email notifications for important updates</p>
                            </div>
                            <nz-switch formControlName="emailNotifications"></nz-switch>
                        </div>

                        <nz-divider></nz-divider>

                        <div class="notification-item">
                            <div class="notification-info">
                                <h4>Workflow Updates</h4>
                                <p>Get notified when workflows complete or fail</p>
                            </div>
                            <nz-switch formControlName="workflowUpdates"></nz-switch>
                        </div>

                        <nz-divider></nz-divider>

                        <div class="notification-item">
                            <div class="notification-info">
                                <h4>System Alerts</h4>
                                <p>Receive alerts about system maintenance and updates</p>
                            </div>
                            <nz-switch formControlName="systemAlerts"></nz-switch>
                        </div>

                        <nz-divider></nz-divider>

                        <div class="notification-item">
                            <div class="notification-info">
                                <h4>Weekly Digest</h4>
                                <p>Get a weekly summary of your activity</p>
                            </div>
                            <nz-switch formControlName="weeklyDigest"></nz-switch>
                        </div>

                        <nz-divider></nz-divider>

                        <div class="notification-item">
                            <div class="notification-info">
                                <h4>Marketing Emails</h4>
                                <p>Receive updates about new features and promotions</p>
                            </div>
                            <nz-switch formControlName="marketingEmails"></nz-switch>
                        </div>

                        <nz-divider></nz-divider>

                        <nz-form-item>
                            <nz-form-control>
                                <button nz-button nzType="primary" nzShape="round" [nzLoading]="loading"
                                    (click)="saveNotificationPreferences()">
                                    <span nz-icon nzType="save" nzTheme="outline"></span>
                                    Save Preferences
                                </button>
                            </nz-form-control>
                        </nz-form-item>
                    </form>
                </nz-card>
            </div>
        </div>
    </div>
</div>